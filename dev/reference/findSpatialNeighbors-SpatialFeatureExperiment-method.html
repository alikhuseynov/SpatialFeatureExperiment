<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function wraps all spatial neighborhood graphs implemented in the
package spdep for the SpatialFeatureExperiment (SFE) class, to
find spatial neighborhood graphs for the entities represented by columns or
rows of the gene count matrix in the SFE object or spatial entities in the
annotGeometries field of the SFE object. Results are stored as
listw objects in the spatialGraphs field of the SFE object, as
listw is used in many methods that facilitate the spatial neighborhood
graph in the spdep, spatialreg, and adespatial. The edge
weights of the graph in the listw object are by default style W (see
nb2listw) and the unweighted neighbor list is in the
neighbours field of the listw object."><title>Find spatial neighborhood graph — findSpatialNeighbors,SpatialFeatureExperiment-method • SpatialFeatureExperiment</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Find spatial neighborhood graph — findSpatialNeighbors,SpatialFeatureExperiment-method"><meta property="og:description" content="This function wraps all spatial neighborhood graphs implemented in the
package spdep for the SpatialFeatureExperiment (SFE) class, to
find spatial neighborhood graphs for the entities represented by columns or
rows of the gene count matrix in the SFE object or spatial entities in the
annotGeometries field of the SFE object. Results are stored as
listw objects in the spatialGraphs field of the SFE object, as
listw is used in many methods that facilitate the spatial neighborhood
graph in the spdep, spatialreg, and adespatial. The edge
weights of the graph in the listw object are by default style W (see
nb2listw) and the unweighted neighbor list is in the
neighbours field of the listw object."><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SpatialFeatureExperiment</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.99.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/SFE.html">Introduction to the SpatialFeatureExperiment class</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Find spatial neighborhood graph</h1>
      
      <div class="d-none name"><code>findSpatialNeighbors-SpatialFeatureExperiment-method.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function wraps all spatial neighborhood graphs implemented in the
package <code>spdep</code> for the <code>SpatialFeatureExperiment</code> (SFE) class, to
find spatial neighborhood graphs for the entities represented by columns or
rows of the gene count matrix in the SFE object or spatial entities in the
<code>annotGeometries</code> field of the SFE object. Results are stored as
<code>listw</code> objects in the <code>spatialGraphs</code> field of the SFE object, as
<code>listw</code> is used in many methods that facilitate the spatial neighborhood
graph in the <code>spdep</code>, <code>spatialreg</code>, and <code>adespatial</code>. The edge
weights of the graph in the <code>listw</code> object are by default style W (see
<code>nb2listw</code>) and the unweighted neighbor list is in the
<code>neighbours</code> field of the <code>listw</code> object.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S4 method for SpatialFeatureExperiment</span></span>
<span><span class="fu">findSpatialNeighbors</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  sample_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"spatialCoords"</span>,</span>
<span>  MARGIN <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tri2nb"</span>, <span class="st">"knearneigh"</span>, <span class="st">"dnearneigh"</span>, <span class="st">"gabrielneigh"</span>, <span class="st">"relativeneigh"</span>,</span>
<span>    <span class="st">"soi.graph"</span>, <span class="st">"poly2nb"</span><span class="op">)</span>,</span>
<span>  glist <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  style <span class="op">=</span> <span class="st">"W"</span>,</span>
<span>  zero.policy <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>A <code><a href="SpatialFeatureExperiment.html">SpatialFeatureExperiment</a></code> object.</p></dd>


<dt>sample_id</dt>
<dd><p>Which sample(s) in the SFE object to use for the graph. Can
also be "all", which means this function will compute the graph for all
samples independently.</p></dd>


<dt>type</dt>
<dd><p>Name of the geometry associated with the MARGIN of interest for
which to compute the graph.</p></dd>


<dt>MARGIN</dt>
<dd><p>Just like in <code><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></code>, where 1 stands for row, 2
stands for column. Here, in addition, 3 stands for annotation, to query the
<code><a href="annotGeometries.html">annotGeometries</a></code>, such as nuclei segmentation in a Visium data</p></dd>


<dt>method</dt>
<dd><p>Name of function in the package <code>spdep</code> to use to find the
spatial neighborhood graph.</p></dd>


<dt>glist</dt>
<dd><p>list of general weights corresponding to neighbours</p></dd>


<dt>style</dt>
<dd><p><code>style</code> can take values “W”, “B”, “C”, “U”, “minmax” and “S”</p></dd>


<dt>zero.policy</dt>
<dd><p>default NULL, use global option value; if FALSE stop with error for any empty neighbour sets, if TRUE permit the weights list to be formed with zero-length weights vectors</p></dd>


<dt>...</dt>
<dd><p>Extra arguments passed to the <code>spdep</code> function stated in the
<code>method</code> argument, such as <code>k</code>, <code>use_kd_tree</code>, <code>d1</code>,
<code>d2</code>, <code>nnmult</code>, <code>sym</code>, and <code>quadsegs</code>. Note that any
arguments about using longitude and latitude, which are irrelevant, are
ignored. The <code>longlat</code> argument is hard coded to <code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>For one sample, then a <code>listw</code> object representing the graph,
  with an attribute "method" recording the function used to build the graph,
  its arguments, and information about the geometry for which the graph was
  built. The attribute is used to reconstruct the graphs when the SFE object
  is subsetted since some nodes in the graph will no longer be present. If
  sample_id = "all" or has length &gt; 1, then a named list of <code>listw</code></p>


<p>objects, whose names are the sample_ids. To add the list for multiple
  samples to a SFE object, specify the <code>name</code> argument in the</p>
<p></p>
<p><code><a href="spatialGraphs.html">spatialGraphs</a></code> replacement method, so graph of the same name
  will be added to the SFE object for each sample.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SFEData</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sfe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SFEData/man/McKellarMuscleData.html" class="external-link">McKellarMuscleData</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"small"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> snapshotDate(): 2022-07-22</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> see ?SFEData and browseVignettes('SFEData') for documentation</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> loading from cache</span>
<span class="r-in"><span><span class="co"># sample_id is optional when only one sample is present</span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">findSpatialNeighbors</span><span class="op">(</span><span class="va">sfe</span>, sample_id <span class="op">=</span> <span class="st">"Vis5A"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">g</span>, <span class="st">"method"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $FUN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "findSpatialNeighbors"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $package</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "SpatialFeatureExperiment"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $args</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $args$method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "tri2nb"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $args$row.names</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] "AAATTACCTATCGATG" "AACATATCAACTGGTG" "AAGATTGGCGGAACGT" "AAGGGACAGATTCTGT"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5] "AATATCGAGGGTTCTC" "AATGATGATACGCTAT" "AATGATGCGACTCCTG" "AATTCATAAGGGATCT"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] "ACGAGTACGGATGCCC" "ACGCTAGTGATACACT" "AGATCGTGCATAAGAT" "AGCGCGGGTGCCAATG"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] "AGCTAGAAGCAGAAGT" "AGGTCGCGGAGTTACT" "AGTGAGCCTCGCCGCC" "AGTGGCGGCAATTTGA"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17] "ATAAGTAGGATTCAGA" "ATAGACAACGGGACCT" "ATAGAGTTATCAACTT" "ATAGGCTAGCTTCGCA"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21] "ATCTGCACCTCTGCGA" "ATTACTTACTGGGCAT" "CAGCTCGACAAGTTAA" "CAGTAGCCCACGCGGT"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] "CAGTCGAGGATGCAAT" "CATGCGACCAGTTTAA" "CCAGTAGTCTGATCCA" "CCATACCTTTACTTGT"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29] "CCTAACTAAGGCTCTA" "CCTCACCTGAGGGAGC" "CCTCACCTTAGCATCG" "CCTCGCGCGATATAGG"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [33] "CCTTTCAATGAAGAAA" "CGACTCAGGATGTTAT" "CGATGGACCCTACGCC" "CGGTAGAGGTGCAGGT"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [37] "CGGTTATCCAACAGTG" "CGGTTCAAGTAGGTGT" "CTAACGAAACTTGCTG" "CTACTATCTTTCAGAG"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [41] "CTAGCCGATGTTATGA" "CTATAAGAGCCAATCG" "CTCAGTCACGACAAAT" "CTCGATATTTGCGAGC"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [45] "CTCGTTTCTAATGTTT" "CTGGTAACGAGCTCTT" "CTTGTGCTCACCGATT" "GACGGTCAATAGAAGC"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [49] "GACTCGCGGGAATGAC" "GAGGGCGCAGCTCTGC" "GATCCTAAATCGGGAC" "GCCAATAGGGCATCTC"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [53] "GCCATATTGCACACAG" "GCCTATAGTGTCAGGG" "GCGCATCCAGTCAGCA" "GCGCTGCTTTGCATTT"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [57] "GGGCTCATCGAACCCA" "GGTCGGATAAACGGCG" "GTACTCCTGGGTATGC" "GTGAACTCCCATTCGA"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [61] "GTGAAGATTTCAAGTG" "TAATCGATCCGTACGT" "TACTGCAATCAATTAC" "TACTTTACTGAGCCGG"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [65] "TAGTCTGTGACGTTGC" "TATCACCCAACCGACC" "TCCGGCCTAGCGTACA" "TCCGTTTAGCCTTGAA"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [69] "TCTAGGTGGCGACGCT" "TCTTACCGGAACTCGT" "TGGAACCACTGACACA" "TTACAGACCTAAATGA"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [73] "TTAGCTAATACGATCT" "TTCCAATCAGAGCTAG" "TTCCGCAGAGAAATAT" "TTCTTTGGTCGCGACG"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [77] "TTGATGTGTAGTCCCG"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $args$style</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "W"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $args$sample_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Vis5A"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $args$type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "spatialCoords"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $args$MARGIN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Returns named list for multiple samples</span></span></span>
<span class="r-in"><span><span class="va">sfe2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SFEData/man/McKellarMuscleData.html" class="external-link">McKellarMuscleData</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"small2"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> snapshotDate(): 2022-07-22</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> see ?SFEData and browseVignettes('SFEData') for documentation</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> loading from cache</span>
<span class="r-in"><span><span class="va">sfe_combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">sfe</span>, <span class="va">sfe2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gs</span> <span class="op">&lt;-</span> <span class="fu">findSpatialNeighbors</span><span class="op">(</span><span class="va">sfe</span>, sample_id <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Lambda Moses, Lior Pachter.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

