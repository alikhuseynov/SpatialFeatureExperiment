<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Local spatial statics like local Moran's I, local Geary's C, Getis-Ord Gi*,
and geographically weighted summary statistics return values at each spatial
location. Just like dimension reductions, these results are clearly
associated with the broader SFE object, so they should have a place within
the object. However, a separate field is needed because these analyses are
conceptually distinct from dimension reduction. Also, each feature (e.g.
gene) can have its own results with values at each location. The
localResults field in the SFE object stores these results that has a
value for each spatial location."><title>Organize results from local spatial statistics — localResults • SpatialFeatureExperiment</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Organize results from local spatial statistics — localResults"><meta property="og:description" content="Local spatial statics like local Moran's I, local Geary's C, Getis-Ord Gi*,
and geographically weighted summary statistics return values at each spatial
location. Just like dimension reductions, these results are clearly
associated with the broader SFE object, so they should have a place within
the object. However, a separate field is needed because these analyses are
conceptually distinct from dimension reduction. Also, each feature (e.g.
gene) can have its own results with values at each location. The
localResults field in the SFE object stores these results that has a
value for each spatial location."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SpatialFeatureExperiment</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.4.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/SFE.html">Introduction to the SpatialFeatureExperiment class</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/pachterlab/SpatialFeatureExperiment/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Organize results from local spatial statistics</h1>
      <small class="dont-index">Source: <a href="https://github.com/pachterlab/SpatialFeatureExperiment/blob/HEAD/R/localResults.R" class="external-link"><code>R/localResults.R</code></a></small>
      <div class="d-none name"><code>localResults.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Local spatial statics like local Moran's I, local Geary's C, Getis-Ord Gi*,
and geographically weighted summary statistics return values at each spatial
location. Just like dimension reductions, these results are clearly
associated with the broader SFE object, so they should have a place within
the object. However, a separate field is needed because these analyses are
conceptually distinct from dimension reduction. Also, each feature (e.g.
gene) can have its own results with values at each location. The
<code>localResults</code> field in the SFE object stores these results that has a
value for each spatial location.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S4 method for SpatialFeatureExperiment,missing,missing</span></span>
<span><span class="fu">localResults</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  sample_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">name</span>,</span>
<span>  features <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  colGeometryName <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  annotGeometryName <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  withDimnames <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for SpatialFeatureExperiment,missing,missing</span></span>
<span><span class="fu">localResults</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  sample_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">name</span>,</span>
<span>  features <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  colGeometryName <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  annotGeometryName <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  withDimnames <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for SpatialFeatureExperiment,ANY,character</span></span>
<span><span class="fu">localResults</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  sample_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">name</span>,</span>
<span>  features <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  colGeometryName <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  annotGeometryName <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  withDimnames <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  swap_rownames <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for SpatialFeatureExperiment,ANY,character</span></span>
<span><span class="fu">localResults</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  sample_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">name</span>,</span>
<span>  features <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  colGeometryName <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  annotGeometryName <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  withDimnames <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for SpatialFeatureExperiment</span></span>
<span><span class="fu">localResultNames</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for SpatialFeatureExperiment,character</span></span>
<span><span class="fu">localResultNames</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for SpatialFeatureExperiment</span></span>
<span><span class="fu">localResultFeatures</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  type <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  colGeometryName <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  annotGeometryName <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  swap_rownames <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for SpatialFeatureExperiment</span></span>
<span><span class="fu">localResultAttrs</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  type <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  <span class="va">feature</span>,</span>
<span>  colGeometryName <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  annotGeometryName <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  swap_rownames <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for SpatialFeatureExperiment,missing</span></span>
<span><span class="fu">localResult</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">type</span>,</span>
<span>  <span class="va">feature</span>,</span>
<span>  colGeometryName <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  annotGeometryName <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sample_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  withDimnames <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  simplify <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  swap_rownames <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for SpatialFeatureExperiment,numeric</span></span>
<span><span class="fu">localResult</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">type</span>,</span>
<span>  <span class="va">feature</span>,</span>
<span>  colGeometryName <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  annotGeometryName <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sample_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  withDimnames <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  simplify <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  swap_rownames <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for SpatialFeatureExperiment,character</span></span>
<span><span class="fu">localResult</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">type</span>,</span>
<span>  <span class="va">feature</span>,</span>
<span>  colGeometryName <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  annotGeometryName <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sample_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  withDimnames <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  simplify <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  swap_rownames <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for SpatialFeatureExperiment,missing</span></span>
<span><span class="fu">localResult</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">type</span>,</span>
<span>  <span class="va">feature</span>,</span>
<span>  colGeometryName <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  annotGeometryName <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sample_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  withDimnames <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for SpatialFeatureExperiment,numeric</span></span>
<span><span class="fu">localResult</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">type</span>,</span>
<span>  <span class="va">feature</span>,</span>
<span>  colGeometryName <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  annotGeometryName <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sample_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  withDimnames <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span></span>
<span><span class="co"># S4 method for SpatialFeatureExperiment,character</span></span>
<span><span class="fu">localResult</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">type</span>,</span>
<span>  <span class="va">feature</span>,</span>
<span>  colGeometryName <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  annotGeometryName <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sample_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  withDimnames <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">value</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>A <code>SpatialFeatureExperiment</code> object.</p></dd>


<dt>sample_id</dt>
<dd><p>Sample ID to get or set geometries.</p></dd>


<dt>name</dt>
<dd><p>Name of the spatial method used, such as "localmoran".</p></dd>


<dt>features</dt>
<dd><p>Features whose local results to get or set, for
<code>localResults</code> getter and setter for multiple features at a time.</p></dd>


<dt>colGeometryName</dt>
<dd><p>Which <code>colGeometry</code> to get or set local results.</p></dd>


<dt>annotGeometryName</dt>
<dd><p>Which <code>annotGeometry</code> to get or set local
results.</p></dd>


<dt>withDimnames</dt>
<dd><p>Logical. If <code>TRUE</code>, then the dimnames (colnames or
rownames) of the gene count matrix should correspond to row names of the
<code>sf</code> data frames of interest.</p></dd>


<dt>...</dt>
<dd><p>Ignored</p></dd>


<dt>value</dt>
<dd><p>Values to set, should be either a matrix or a data frame.</p></dd>


<dt>swap_rownames</dt>
<dd><p>Name of a column in <code>rowData</code> to identify features
instead of the row names of the SFE object. For example, if the row names
of the SFE object are Ensembl IDs and gene symbols are in the "symbol"
column in <code>rowData</code>, then putting "symbol" for this argument will use
the gene symbols to identify which gene's local results to get or set.</p></dd>


<dt>type</dt>
<dd><p>Name or index of the spatial method used, such as "localmoran".</p></dd>


<dt>feature</dt>
<dd><p>Feature whose local results to get or set, for
<code>localResult</code> getter and setter for one feature at a time.</p></dd>


<dt>simplify</dt>
<dd><p>Basically whether to return the content of the list rather
than a list when the list only has one element, such as results for one
type and one feature.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>localResults</code> returns a named list each element of which is a
  set of local results of interest. <code>localResult</code> returns a matrix or a
  data frame, whichever the original is when it's set.</p>
<p></p>
<p><code>localResultNames</code> returns a character vector. Setters return an SFE
  object with the desired field set. For genes and <code>colData</code> columns,
  the local results are stored in the <code>localResults</code> field in</p>
<p></p>
<p><code>int_colData</code>, whereas for <code>colGeometries</code> and</p>
<p></p>
<p><code>annotGeometries</code>, the local results are stored as columns in the same</p>
<p></p>
<p><code>sf</code> data frames. <code>localResultFeatures</code> returns a character
  vector of names of features for which local results are available.</p>
<p></p>
<p><code>localResultAttrs</code> returns a character vector of the column names of
  the local results of one type for one feature. It returns <code>NULL</code> if
  the results are a vector.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Toy example</span></span></span>
<span class="r-in"><span><span class="va">sfe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/sfe_toy.rds"</span>,</span></span>
<span class="r-in"><span>    package <span class="op">=</span> <span class="st">"SpatialFeatureExperiment"</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># localResults functions are written for organizing results from local</span></span></span>
<span class="r-in"><span><span class="co"># spatial statistics (see the Voyager package). But for the examples here,</span></span></span>
<span class="r-in"><span><span class="co"># random toy matrices are used. The real results are often matrices, with a</span></span></span>
<span class="r-in"><span><span class="co"># matrix for each feature.</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/S4Vectors" class="external-link">S4Vectors</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">29</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">toy_res1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    nrow <span class="op">=</span> <span class="fl">5</span>, ncol <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>    dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">sfe</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"meow"</span>, <span class="st">"purr"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">toy_res1b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="fl">10</span>, shape <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    nrow <span class="op">=</span> <span class="fl">5</span>, ncol <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>    dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">sfe</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"meow"</span>, <span class="st">"purr"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">toy_df1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a></span><span class="op">(</span>gene1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">toy_res1</span><span class="op">)</span>, gene2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">toy_res1b</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">toy_res2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">10</span>, lambda <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    nrow <span class="op">=</span> <span class="fl">5</span>, ncol <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>    dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">sfe</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sassy"</span>, <span class="st">"tortitude"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">toy_df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a></span><span class="op">(</span>gene1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">toy_res2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Set all local results</span></span></span>
<span class="r-in"><span><span class="fu">localResults</span><span class="op">(</span><span class="va">sfe</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>localmoran <span class="op">=</span> <span class="va">toy_df1</span>, Gistar <span class="op">=</span> <span class="va">toy_df2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Get all local results</span></span></span>
<span class="r-in"><span><span class="va">lrs</span> <span class="op">&lt;-</span> <span class="fu">localResults</span><span class="op">(</span><span class="va">sfe</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Set results of the same type for multiple genes</span></span></span>
<span class="r-in"><span><span class="fu">localResults</span><span class="op">(</span><span class="va">sfe</span>, name <span class="op">=</span> <span class="st">"localmoran"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">toy_df1</span></span></span>
<span class="r-in"><span><span class="co"># Can also use a list</span></span></span>
<span class="r-in"><span><span class="fu">localResults</span><span class="op">(</span><span class="va">sfe</span>, name <span class="op">=</span> <span class="st">"localmoran"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">toy_df1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Get results of the same type for multiple genes</span></span></span>
<span class="r-in"><span><span class="va">lrs</span> <span class="op">&lt;-</span> <span class="fu">localResults</span><span class="op">(</span><span class="va">sfe</span>, name <span class="op">=</span> <span class="st">"localmoran"</span>, features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gene1"</span>, <span class="st">"gene2"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Set results for one type and one gene</span></span></span>
<span class="r-in"><span><span class="fu">localResult</span><span class="op">(</span><span class="va">sfe</span>, <span class="st">"localmoran"</span>, feature <span class="op">=</span> <span class="st">"gene1"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">toy_res1</span></span></span>
<span class="r-in"><span><span class="co"># Get results for one type and one gene</span></span></span>
<span class="r-in"><span><span class="va">lr</span> <span class="op">&lt;-</span> <span class="fu">localResult</span><span class="op">(</span><span class="va">sfe</span>, <span class="st">"localmoran"</span>, feature <span class="op">=</span> <span class="st">"gene1"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Set results for a feature in colGeometries</span></span></span>
<span class="r-in"><span><span class="va">cg_toy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/cg_toy.rds"</span>,</span></span>
<span class="r-in"><span>    package <span class="op">=</span> <span class="st">"SpatialFeatureExperiment"</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="dimGeometries.html">colGeometry</a></span><span class="op">(</span><span class="va">sfe</span>, <span class="st">"cg"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">cg_toy</span></span></span>
<span class="r-in"><span><span class="fu">localResult</span><span class="op">(</span><span class="va">sfe</span>, <span class="st">"localmoran"</span>,</span></span>
<span class="r-in"><span>    feature <span class="op">=</span> <span class="st">"gene1"</span>,</span></span>
<span class="r-in"><span>    colGeometryName <span class="op">=</span> <span class="st">"cg"</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">toy_res1</span></span></span>
<span class="r-in"><span><span class="co"># Get results for a feature in colGeometries</span></span></span>
<span class="r-in"><span><span class="va">lr</span> <span class="op">&lt;-</span> <span class="fu">localResult</span><span class="op">(</span><span class="va">sfe</span>, <span class="st">"localmoran"</span>, <span class="st">"gene1"</span>, colGeometryName <span class="op">=</span> <span class="st">"cg"</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Lambda Moses, Lior Pachter.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

